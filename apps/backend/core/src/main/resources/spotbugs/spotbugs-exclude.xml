<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!-- Lombok generated code (inner classes, builder patterns) -->
    <Match>
        <Class name="~.*\$.*"/>
    </Match>

    <!-- gRPC generated code -->
    <Match>
        <Package name="~.*\.grpc\..*"/>
    </Match>

    <!-- Protobuf generated code -->
    <Match>
        <Class name="~.*\.proto\..*"/>
    </Match>

    <!-- Record classes - Defensive copy not needed for immutable records -->
    <Match>
        <Or>
            <Bug pattern="EI_EXPOSE_REP"/>
            <Bug pattern="EI_EXPOSE_REP2"/>
        </Or>
        <Class name="~.*Record$"/>
    </Match>

    <!-- DTOs and Request/Response classes - Often designed for data transfer -->
    <Match>
        <Or>
            <Class name="~.*DTO$"/>
            <Class name="~.*Request$"/>
            <Class name="~.*Response$"/>
        </Or>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>

    <!-- Spring Boot Configuration Properties - Framework managed -->
    <Match>
        <Class name="~.*Properties$"/>
        <Or>
            <Bug pattern="EI_EXPOSE_REP"/>
            <Bug pattern="EI_EXPOSE_REP2"/>
        </Or>
    </Match>

    <!-- Spring Boot Application main class -->
    <Match>
        <Class name="~.*Application$"/>
        <Bug pattern="ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD"/>
    </Match>

    <!-- Test classes - More lenient rules -->
    <Match>
        <Or>
            <Class name="~.*Test$"/>
            <Class name="~.*Tests$"/>
            <Class name="~.*TestCase$"/>
        </Or>
        <Or>
            <Bug pattern="RCN_REDUNDANT_NULLCHECK_OF_NONNULL_VALUE"/>
            <Bug pattern="NP_NULL_ON_SOME_PATH"/>
        </Or>
    </Match>

    <!-- Reactor/WebFlux patterns - Intentional blocking operations in tests -->
    <Match>
        <Or>
            <Class name="~.*Test$"/>
            <Class name="~.*Tests$"/>
        </Or>
        <Bug pattern="RV_RETURN_VALUE_IGNORED"/>
    </Match>

    <!-- Missing classes from compilation (synthetic methods, third-party dependencies) -->
    <Match>
        <Bug pattern="UNKNOWN"/>
    </Match>

    <!-- Security: SQL Injection - False positives with prepared statements -->
    <Match>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>

    <!-- Performance: Inner class could be static - Intentional for Spring context -->
    <Match>
        <Class name="~.*Configuration\$.*"/>
        <Bug pattern="SIC_INNER_SHOULD_BE_STATIC_ANON"/>
    </Match>

    <!-- TODO: Fix - DbVendor masks id field from BaseEntity -->
    <Match>
        <Class name="com.schemafy.core.erd.repository.entity.DbVendor"/>
        <Bug pattern="MF_CLASS_MASKS_FIELD"/>
    </Match>

    <!-- Spring Bean constructors may throw exceptions during initialization -->
    <Match>
        <Class name="com.schemafy.core.common.security.jwt.JwtProvider"/>
        <Bug pattern="CT_CONSTRUCTOR_THROW"/>
    </Match>
</FindBugsFilter>