# ERD 모델링 무결성 검증 로직 TC 스펙

## 1. 순환 관계 검증 TC

### TC-001: 순환 관계 감지 및 처리

#### TC-001-1: 직접 순환 관계 생성 차단

- **설명**: 동일 엔티티 간 직접적인 순환 관계 생성 시도 감지
- **전제조건**: 엔티티 A가 존재
- **입력**: A → A 관계 생성 요청
- **예상결과**: 부분 참여로 관계 수정 및 경고
- **검증항목**:
  - 부분 참여로 관계 수정
  - "자기 참조 관계는 허용되지 않습니다" 경고 메시지 표시

#### TC-001-2: 간접 순환 관계 감지

- **설명**: 여러 엔티티를 거친 간접적인 순환 관계 감지
- **전제조건**: A → B → C 관계가 이미 존재
- **입력**: C → A 관계 생성 요청
- **예상결과**: 부분 참여로 관계 수정 및 경고
- **검증항목**:
  - 순환 경로 A → B → C → A 감지
  - 부분 참여로 관계 수정
  - 순환 관계 경고 메시지 표시

## 2. 엔티티 삭제 시 연쇄 처리 TC

### TC-002: 관계 연쇄 삭제 검증

#### TC-002-1: 1:1, 1:N 관계에서 부모 엔티티 삭제

- **설명**: 자식 엔티티가 있는 부모 엔티티 삭제 시 연쇄 처리
- **전제조건**: Department(1) -> Employee(N) 관계 존재
- **입력**: Department 엔티티 삭제 요청
- **예상결과**: 연쇄 삭제 제공
- **검증항목**:
  - Department -> Employee 관계 삭제
  - 연관된 Employee들의 옵션 함께 삭제

#### TC-002-2: N:M 관계에서 엔티티 삭제

- **설명**: 다대다 관계에서 한쪽 엔티티 삭제 시 처리
- **전제조건**: Student ↔ Course 다대다 관계 존재
- **입력**: Student 엔티티 삭제 요청
- **예상결과**: 중간 테이블 데이터 자동 삭제
- **검증항목**:
  - Student-Course 연결 테이블의 해당 학생 레코드 모두 삭제
  - Course 엔티티는 영향받지 않음

### TC-003: 속성 삭제 시 연쇄 처리

#### TC-003-1: PK 속성 삭제 시도

- **설명**: PK로 사용되는 속성 삭제 시도 차단
- **전제조건**: Employee 엔티티의 EmpID가 PK
- **입력**: EmpID 속성 삭제 요청
- **예상결과**: 삭제 차단
- **검증항목**:
  - PK 속성 삭제 거부

#### TC-003-2: FK 속성 삭제

- **설명**: FK로 사용되는 속성 삭제 시 관계 처리
- **전제조건**: Employee.DeptID가 Department.ID를 참조
- **입력**: Employee.DeptID 속성 삭제 요청
- **예상결과**: 관계 삭제
- **검증항목**:
  - 연관된 관계도 함께 삭제

## 3. 관계 생성 시 무결성 검증 TC

### TC-004: 관계 차수 제약 검증

#### TC-004-1: 관계에서 자식측 FK 생성

- **설명**: 관계 생성 시 자식측에 FK 자동 생성
- **전제조건**: Department와 Employee 엔티티 존재
- **입력**: Department(1) → Employee(N) 관계 생성
- **예상결과**: Employee에 FK 자동 생성
- **검증항목**:
  - Employee 테이블에 DepartmentID FK 추가

#### TC-004-2: N:M 관계에서 연결 테이블 생성

- **설명**: N:M 관계 생성 시 중간 테이블 자동 생성
- **전제조건**: Student와 Course 엔티티 존재
- **입력**: Student(N) ↔ Course(M) 관계 생성
- **예상결과**: 연결 테이블 자동 생성
- **검증항목**:
  - Student_Course 연결 테이블 생성
  - 양쪽 엔티티의 PK를 FK로 포함

### TC-005: 참여 제약 검증

#### TC-005-1: 부분참여에서 전체참여로 변경

- **설명**: 기존 부분참여 관계를 전체참여로 변경 시 검증
- **전제조건**: Employee-Department가 부분참여 관계
- **입력**: 전체참여로 변경 요청
- **예상결과**: 기존 데이터 검증 후 변경
- **검증항목**:
  - 순환이 검증되는 데이터가 있으면 변경 차단
  - 기존 FK를 PK/FK로 수정

## 4. 참조 무결성 검증 TC

### TC-006: FK 참조 무결성

#### TC-006-1: 존재하지 않는 참조값 입력 차단

- **설명**: FK가 참조하는 값이 존재하지 않을 때 차단
- **전제조건**: Employee.DeptID가 Department.ID를 참조
- **입력**: 존재하지 않는 DeptID로 Employee 생성
- **예상결과**: 참조 무결성 위반 차단
- **검증항목**:
  - FK 값이 참조 테이블에 존재하는지 검증
  - "참조하는 값이 존재하지 않습니다" 오류 메시지

#### TC-006-2: 참조되는 데이터 삭제 시도

- **설명**: 다른 테이블에서 참조되는 데이터 삭제 시도
- **전제조건**: Department ID=1이 Employee에 의해 참조됨
- **입력**: Department ID=1 삭제 요청
- **예상결과**: FK와 관계 삭제
- **검증항목**:
  - 연관된 관계와 Employee의 FK 삭제

#### TC-006-3: 참조되는 PK 값 수정 시도

- **설명**: 다른 테이블에서 참조되는 PK 값 수정 시 처리
- **전제조건**: Department.ID가 여러 Employee.DeptID에 의해 참조됨
- **입력**: Department.ID 값 변경 요청
- **예상결과**: 연쇄 업데이트
- **검증항목**:
  - 모든 참조 테이블의 FK 값도 함께 변경

## 5. 데이터 타입 및 제약 조건 검증 TC

### TC-007: 속성 데이터 타입 검증

#### TC-007-1: NULL 허용 여부 검증

- **설명**: FK의 NULL 허용 여부와 참여 제약의 일관성 검증
- **전제조건**: Employee-Department 전체참여 관계에서 Employee.DeptID가 NULL 허용
- **입력**: 관계 설정 완료 시점
- **예상결과**: 제약 조건 불일치 감지
- **검증항목**:
  - 부분참여로 변경

## 6. 엔티티 명명 및 식별 검증 TC

### TC-008: 명명 규칙 검증

#### TC-008-1: 엔티티명 중복 검증

- **설명**: 동일 스키마 내 엔티티명 중복 방지
- **전제조건**: "Employee" 엔티티가 이미 존재
- **입력**: 동일한 "Employee" 엔티티 생성 시도
- **예상결과**: 중복 엔티티명 차단
- **검증항목**:
  - 대소문자 구분 없이 중복 검사
  - "이미 존재하는 엔티티명입니다" 오류 메시지
  - 대안 이름 제안

#### TC-008-2: 속성명 중복 검증

- **설명**: 동일 엔티티 내 속성명 중복 방지
- **전제조건**: Employee 엔티티에 "Name" 속성 존재
- **입력**: 동일한 "Name" 속성 추가 시도
- **예상결과**: 중복 속성명 차단
- **검증항목**:
  - 대소문자 구분 없이 중복 검사
  - "이미 존재하는 속성명입니다" 오류 메시지
  - 대안 이름 제안

### TC-009: 식별자 무결성 검증

#### TC-009-1: PK 존재 검증

- **설명**: 모든 엔티티에 PK 존재 여부 검증
- **전제조건**: PK가 없는 엔티티 생성 시도
- **입력**: PK 없이 엔티티 저장 요청
- **예상결과**: PK 필수 요구
- **검증항목**:
  - "PK가 필요합니다" 경고 메시지
  - 자동 ID 생성 옵션 제공

## 7. 테스트 및 엣지 케이스

### TC-010: 복합 시나리오 검증

#### TC-010-1: 실시간 협업 환경에서의 무결성 검증

- **설명**: 여러 사용자가 동시에 편집하는 환경에서의 실시간 무결성 검증
- **전제조건**: 다중 사용자가 동일 스키마를 편집 중
- **입력**: 사용자별 동시 변경 작업
- **예상결과**: 실시간 충돌 감지 및 해결
- **검증항목**:
  - 사용자간 변경 사항 충돌 해결
  - 변경 사항 동기화 및 일관성 유지

#### TC-010-2: 레거시 데이터 무결성 검증

- **설명**: 기존 시스템에서 가져온 레거시 데이터의 무결성 검증
- **전제조건**: 외부 시스템에서 가져온 스키마 및 데이터
- **입력**: 레거시 데이터 임포트
- **예상결과**: 무결성 위반 항목 식별 및 정리 방안 제시
- **검증항목**:
  - 기존 데이터의 무결성 위반 항목 식별
  - 데이터 정리 우선순위 제시
